<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Form Data Pegawai</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f7f8fc;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 700px;
      margin: 40px auto;
      background: #fff;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
      color: #333;
      margin-bottom: 20px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #444;
    }
    input, select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
    }
    button {
      width: 100%;
      padding: 12px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      transition: 0.2s;
    }
    button:hover {
      background: #2563eb;
    }
    .msg {
      text-align: center;
      margin-top: 15px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div class="container">
  <h2>Form Data Pegawai</h2>
  <form id="pegawaiForm">
    <div class="form-group"><label>NIP Pegawai</label><input name="nip_pegawai" required></div>
    <div class="form-group"><label>Nama Pegawai</label><input name="nama_pegawai" required></div>
    <div class="form-group"><label>Tanggal Lahir</label><input type="date" name="tanggal_lahir_pegawai" required></div>
    <div class="form-group"><label>Tipe Jabatan</label><input name="tipe_jabatan"></div>
    <div class="form-group"><label>Nama Jabatan</label><input name="nama_jabatan"></div>
    <div class="form-group"><label>Status ASN</label>
      <select name="status_asn" required>
        <option value="">-- PILIH STATUS --</option>
        <option>PNS</option><option>PPPK</option><option>CPNS</option>
      </select>
    </div>
    <div class="form-group"><label>Eselon</label>
      <select name="eselon">
        <option value="">-- PILIH ESELON --</option>
        <option>Non Eselon</option><option>IA</option><option>IB</option>
        <option>IIA</option><option>IIB</option><option>IIIA</option>
        <option>IIIB</option><option>IVA</option><option>IVB</option>
      </select>
    </div>
    <div class="form-group"><label>Golongan</label>
      <select name="golongan">
        <optgroup label="PNS">
          <option>II/A</option><option>II/B</option><option>II/C</option><option>II/D</option>
          <option>III/A</option><option>III/B</option><option>III/C</option><option>III/D</option>
          <option>IV/A</option><option>IV/B</option><option>IV/C</option>
        </optgroup>
        <optgroup label="PPPK">
          <option>V</option><option>VI</option><option>VII</option><option>VIII</option>
          <option>IX</option><option>X</option>
        </optgroup>
      </select>
    </div>
    <div class="form-group"><label>Masa Kerja Golongan</label><input name="masa_kerja_golongan"></div>
    <div class="form-group"><label>Status Pernikahan</label>
      <select name="status_pernikahan">
        <option></option><option>KAWIN</option><option>BELUM KAWIN</option><option>DUDA</option><option>JANDA</option>
      </select>
    </div>
    <div class="form-group"><label>Jumlah Istri/Suami</label><input type="number" name="jumlah_istri_suami"></div>
    <div class="form-group"><label>Jumlah Anak</label><input type="number" name="jumlah_anak"></div>
    <div class="form-group"><label>Jumlah Tanggungan</label><input type="number" name="jumlah_tanggungan"></div>
    <div class="form-group"><label>Pasangan PNS</label>
      <select name="pasangan_pns"><option></option><option>YA</option><option>TIDAK</option></select>
    </div>
    <div class="form-group"><label>NIP Pasangan</label><input name="nip_pasangan"></div>
    <button type="submit">Simpan Data</button>
    <div class="msg" id="msg"></div>
  </form>
</div>

<script>
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbywbTibmqmoTX3iVbMJu-v9e_mCicPIxcOnYFSmAU5cqfjnK3NfbTVTq7ElZUc31_rp/exec'; // ganti dengan URL Web App dari Apps Script

  document.getElementById("pegawaiForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const form = e.target;
    const msg = document.getElementById("msg");

    msg.innerText = "Menyimpan data...";

    try {
      const res = await fetch(SCRIPT_URL, {
        method: "POST",
        body: new FormData(form)
      });
      const result = await res.json();
      if (result.status === "success") {
        msg.style.color = "green";
        msg.innerText = "✅ Data berhasil disimpan!";
        form.reset();
      } else {
        msg.style.color = "red";
        msg.innerText = "❌ Gagal: " + result.message;
      }
    } catch (err) {
      msg.style.color = "red";
      msg.innerText = "❌ Error: " + err.message;
    }
  });
</script>

</body>
</html>

